{"path":"Alte semester/Images/Tag3_03_Kryptographie.pdf","text":"1 Informationssicherheit und IT-Forensik 1-04 – Kryptographie Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 2 Begrüßung  Mein Name: Phil Knüfer  Lehrbeauftragter des Martin Wundram ;)  Dritter Übungsdurchlauf  bzw. heute: zweite Vorlesung Krypto Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 3 Kurzvorstellung  angestellt bei DigiTrace  Penetrationstests  Sicherheitsberatung  Incident Response  IT-Forensik Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 4 Kurzvorstellung  Studium  B.Sc. IT-Sicherheit  M.Sc. IT-Sicherheit  Ruhr-Uni Bochum © RUB, Marquard Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 5 Kontakt und Feedback Fragen?  Gern auch über die Übung hinaus:  zum ITS-Studium  zum Beruf  …  phil.knuefer@rub.de Feedback?  Weiterhin im Internet: https://feedback.wundram.de Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 6 Grundlagen Lernziele dieser Einheit:  Grundüberlegungen der Kryptographie verstehen und anwenden können  Kryptographische Verfahren kennen und einordnen können  Essentielle Verfahren verstehen und anwenden können  Erkennen, dass Kryptographie als eigenes Forschungs- und Anwendungsfeld sehr anspruchsvoll ist → typischerweise besser nicht selbst Verfahren ausdenken  Bereits die korrekte Implementierung bekannter Verfahren hat schon so Manchen vor unlösbare Probleme gestellt… Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 7 Cryptography - Making sure data is lost Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 8 Cryptography - Making sure data is lost Hand aufs Herz: Wer hat schon einmal Daten verschlüsselt und konnte später, aus welchem Grund auch immer, nicht mehr darauf zugreifen? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 9 Grundüberlegungen Der Reiz des Verborgenen  \"Der Drang, Geheimnisse aufzudecken, ist im Wesen des Menschen tief eingewurzelt; schon die einfachste Neugier beruht ja auf der Aussicht, ein Wissen zu teilen, das andere uns vorenthalten. Einige sind glücklich genug, einen Beruf zu finden, der in der Lösung von Rätseln besteht. Aber die meisten von uns müssen diesen Drang mit der Lösung künstlich zu unserer Unterhaltung ausgedachter Rätselaufgaben stillen. Detektivgeschichten und Kreuzworträtsel werden vielen nutzen; einige wenige mögen sich der Entschlüsselung von Geheimschriften hingeben.\" - John Chadwick, „Linear B: Die Entzifferung der mykenischen Schrift“ Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 10 Grundüberlegungen Die Notwendigkeit zum Verborgenen  Das Problem der Nachrichtenintegrität und Vertraulichkeit/Geheimhaltung ist jahrtausendealt  Schon in der Antike haben Geschäftsleute z.B. bei Viehtransporten ihren Spediteuren verschlossene und versiegelte Tonkugeln mit darin enthaltenen Stücklisten übergeben  Der Empfänger zerbrach die Kugel und das Siegel und überprüfte dann, ob die Lieferung vollständig ist  Auch technische Steganographie ist seit der Antike bekannt: Sklaven wurde der Kopf geschoren und eine geheime Nachricht auf die Kopfhaut tätowiert… Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 11 Grundüberlegungen Das Problem der IT-Forensiker  Müssen Nachrichten untereinander vertraulich und verlässlich austauschen  Eigenes Interesse an wirksamem Schutz  Müssen Vorgänge aufklären und damit fremde Nachrichten lesen können und verstehen  Interesse an unwirksamem Schutz bei Dritten  Zugleich Interesse an verlässlicher Spurenlage Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 12 Grundüberlegungen Kryptographie schützt nicht (immer?)  “Cryptography is usually bypassed. I am not aware of any major world-class security system employing cryptography in which the hackers penetrated the system by actually going through the cryptanalysis. (. . . ) Usually there are much simpler ways of penetrating the security system.” - Adi Shamir, Turing Award lecture, 2002 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 13 Grundüberlegungen Kryptographie schützt nicht (immer?)  “The encryption doesn’t even have to be very strong to be useful, it just must be stronger than the other weak links in the system. Using any standard commercial risk management model, cryptosystem failure is orders of magnitude below any other risk.” - Ian Grigg, Peter Gutmann, IEEE Security & Privacy 9(3), 2011  “If you think like an attacker, then you’re a fool to worry about the crypto. Go buy a few zero days.” - Jon Callas, randombit.net cryptography list, 2011 Quelle: Zitatauswahl übernommen von https://media.blackhat.com/bh-ad-11/Aumasson/bh-ad-11-Aumasson-CryptanalysisVSReality_Slides.pdf Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 14 Grundüberlegungen Kryptographie schützt nicht (immer?)  Angreifer werden also typischerweise versuchen, die sichere Crypto zu „umschiffen“  Wenn die Passphrase 123456 lautet, bringt das sicherste Verfahren nichts  Wenn ein eigentlich sicheres Verfahren kaputt-implementiert wurde, ist das gesamte System kaputt  Interessanter Artikel zu diesen Überlegungen: http://www.linux-magazin.de/ausgaben/2014/08/krypto-fails/2/ Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 15 Grundüberlegungen Rubberhose Cryptanalytics  „...the rubber-hose technique of cryptanalysis. (in which a rubber hose is applied forcefully and frequently to the soles of the feet until the key to the cryptosystem is discovered, a process that can take a surprisingly short time and is quite computationally inexpensive)” Marcus Ranum, 1990, https://groups.google.com/foru m/#!msg/sci.crypt/W1VUQlC9 9LM/ANkI5zdGQIYJ Quelle: https://xkcd.com/538/ Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 16 Der Fall Maria Stuart Hintergrund (vereinfacht)  Maria Stuart (1542-1587), Königin von Schottland und später des Hochverrats angeklagt, verurteilt und hingerichtet  Ihre Gegnerin: Elisabeth I., Königin von England und Irland  Der Streit (unter anderem): Maria erhebt Anspruch auf den Thron Englands; Maria hat angeblich Mitschuld an der Tötung ihres Mannes  Das Problem: Verwandtschaft der beiden und politische Herausforderungen  Erste Lösung: Elisabeth hält Maria lediglich gefangen und lehnt eine Hinrichtung ab Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 17 Der Fall Maria Stuart Das Babington-Komplott  1586 ließ Maria Stuart sich von Anthony Babington für eine Verschwörung gewinnen  Befreiung Marias  Tötung Elisabeths  Die Verschwörer und Maria kommunizierten untereinander über verschlüsselte Nachrichten  Diese wurden jedoch abgefangen, entschlüsselt und Maria Stuart schließlich 1587 nach Auswertung ihrer Schriftstücke hingerichtet  Maßgeblich beteiligt: Francis Walsingham (Sicherheitsminister) und Thomas Phelippes (Geheimsekretär, Codeknacker) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 18 Der Fall Maria Stuart Das Krypto-Verfahren  Verwendet wurde ein Nomenklator (monoalphabetische Substitutionschiffre plus 36 Symbole für Wörter und Sätze plus 4 Null-Füller und 1 Doppler-Symbol)  Phelippes machte darauf erfolgreich eine Häufigkeitsanalyse  Schon 1553 Erfindung/Veröffentlichung der 300 Jahre ungebrochenen Vigenère- Verschlüsselung… Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 19 Abgrenzung – Steganographie Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 20 Steganographie – Die Kunst des Versteckens  Steganographie ist verwandt mit Kryptographie, verfolgt aber ein anderes Ziel:  Kryptographische Verfahren verbergen den Inhalt von Nachrichten  Steganographische Verfahren verbergen Nachrichten bzw. Übertragungskanäle  A sendet Nachricht an B → Darin enthalten geheime Nachricht  A sendet Nachricht an B → Transaktion selbst bleibt geheim  Steganographische Verfahren sind genau dann sicher, wenn Dritte aus der Analyse eines Mediums keinerlei Rückschlüsse auf darin evtl. enthaltene verborgene Informationen ziehen können  Symmetrische Steganographie  Asymmetrische Steganographie  Technische Steganographie (z.B. Sklavenkopf, Mikropunkt)  Semagramme (z.B. Morsecode in Grashalmlängen in einem Bild) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 21 Steganographie – Die Kunst des Versteckens  Das Verfahren des Versteckens selbst muss typischerweise geheim gehalten werden → der Angreifer weiß sonst, wo er wie schauen muss  Linguistische Steganographie  Geheimsprachen  Maskierte Geheimschriften  Marihuana -> „Gras“  Getarnte Geheimschriften  z.B. Cardan-Gitter Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 22 Steganographie – Die Kunst des Versteckens  Cardan-Gitter (erfunden ca. 1550 von Gerolamo Cardano)  Früher durch die individuelle Schablone als Verschlüsselung betrachtet. Gehört jedoch zur Steganographie. Grafik von Stevebkk/Wikipedia Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 23 Steganographie – Die Kunst des Versteckens  Beispielhafte Einbettung von Daten in ein JPG-Bild  15 Einbettungen zu je 4 Bit = 60 Bit = 7,5 Byte Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 24 Steganographie – Die Kunst des Versteckens  Steganalyse ist das Gegenstück zur Steganographie. Hat das „Problem“, dass Nachrichten zunächst nur vermutet werden können  1. Herausfinden, ob in einem Datenblock versteckte Informationen enthalten sein kann, oder aber ausgeschlossen werden kann  2. Erkennen und Wiederherstellen der verborgenen Informationen  Verwendet werden oft statistische Tests  Digitale Wasserzeichen sind eine Unterart der Steganographie  Sind jedoch besonders Robust gegen Änderungen im Trägermedium  Steganographie und Kryptologie lassen sich gut kombinieren  Frage: Warum macht eine Verschlüsselung vorab besonders Sinn? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 25 Was ist Kryptologie Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 26  Techniken für Shared Secrets  Elektronische Wahlverfahren  Identifikationsprotokolle Was ist Kryptologie Begriff und Wissenschaftsgebiet  Griechischer Ursprung, zusammengesetzt aus  kryptós = „versteckt, verborgen, geheim“  lógos = „Lehre“  Wissenschaft, die sich mit Informationssicherheit beschäftigt  Ursprünglich die vertrauliche Übertragung von Nachrichten  Seit dem 20 Jahrhundert vielfältigere Anwendungen  Hashfunktionen  Ecash  Digitale Signaturen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 27 Was ist Kryptologie  Kryptographie  Ursprünglich die Wissenschaft der Verschlüsselung  Mittlerweile allgemein Themen der Informationssicherheit  Ziel: Absicherung von Nachrichten, so dass diese von unbefugten Dritten nicht gelesen/verstanden werden können  Symmetrische Kryptographie und Asymmetrische Kryptographie als Bausteine  Daraus Protokolle für reale Anforderungen erstellen  „Auf dem Papier“, mechanisch, elektronisch und am Computer  Kryptoanalyse  Gegenstück zur Kryptographie  Versucht Nachrichten, Schlüssel oder gleich ganze Verfahren zu analysieren, bzw. auch zu „brechen“  Instrument zum Nachweis/Test der Sicherheit von Verfahren  Kryptographie und Kryptoanalyse sind Teilgebiete der Kryptologie. Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 28 Ziele der Kryptographie  Grundsätzliche Schutzziele  Vertraulichkeit - Confidentiality  Integrität - Integrity  Verfügbarkeit - Availability  Erweiterte Schutzziele  Zurechenbarkeit  Nicht-Abstreitbarkeit  Nicht-Verkettbarkeit  Anonymität  Es lassen sich weitere Schutzziele hinzufügen (z.B. Konsistenz, Fairness)  Ein Kryptoverfahren muss jedoch nicht zwangsläufig jedes dieser Ziele erfüllen CIA Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 29 Weitere Terminologie  Ein Alphabet A ist eine endliche Menge von Zeichen.  n = |A| ist die Mächtigkeit eines Alphabets  Eine ursprüngliche Nachricht (message) nennt man Klartext (plain text) und bezeichnet sie mit M. M wird als Zeichenkette aus A gebildet:  A = {0, 1} und M1 = 001101010 und M2 = 111111110  Eine verschlüsselte Nachricht nennt man Geheimtext (ciphertext) oder Ciffrat, kurz C. Diese Nachricht C ist eine Zeichenkette über A oder einem anderen Alphabet  Auch die verwendeten Schlüssel (key), bezeichnet mit K, sind Zeichenketten  Durch Verschlüsselung oder Chiffrierung wird eine Nachricht unkenntlich gemacht Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 30 Weitere Terminologie  Chiffre E (encryption)  Invertierbare Abbildung (d.h. es gibt eine Umkehroperation)  Erzeugt aus M und einem Schlüssel K das Chriffrat C (ciphertext)  Entschlüsselung D (decryption)  Umkehropereration zu E: D(E(M)) = M  Erzeugt aus C und einem Schlüssel K wieder den ursprünglichen Klartext M  Begriffsabgrenzung  Chiffrierung: Oben skizziertes Verfahren  Codierung: Alle Zeichen aus A werden Zeichen aus einem anderen Alphabet B zugeordnet (z.B. BASE64, ASCII, UTF-8)  Entschlüsseln: Umkehroperation D zu E  Kryptoanalyse: „brechen“ einer Nachricht ohne Kenntnis von E oder K Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 31 Weitere Terminologie  Kryptographische Algorithmen  Mathematische Funktionen zur Verschlüsselung und Entschlüsselung von Nachrichten  Sind wie andere Algorithmen auch eine strukturierte Vorgehensanweisung, die Schritt für Schritt abgearbeitet werden kann → in der Moderne meist durch Computer  Kryptographisches System (Kryptosystem)  1) Kombination aus Algorithmus und Schlüsselmanagement zur Verwendung in einer Anwendung  2) Kombination aus Algorithmen und Schlüsseln zum Ver- und Entschlüsseln von Nachrichten  RFC 4949 empfiehlt Variante 1, da diese mehr Anwendungsmöglichkeiten umfasst (etwa digitale Signaturen)  RFC 2828 rät von Verwendung der Kurzform Cryptosystem wegen Mehrdeutigkeit ab  Protokolle gehen über Algorithmen hinaus, denn sie steuern und definieren komplette Transaktionen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 32 Weitere Terminologie  Alice: Kommunikationspartner A  Bob: Kommunikationspartner B  Eve: Angreifer, der passiv mithört (von engl. to eavesdrop = abhören)  Mallory: Angreifer, der aktiv eingreift (von engl. malicious = bösartig) A B E M A B E M Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 33 Verschlüsselugsmethoden Symmetrische Algorithmen  Der gleiche Schlüssel K wird zum Verschlüsseln und Entschlüsseln verwendet  EK(M) = C  DK(C) = M  DK(EK(M)) = M  Blockverschlüsselung (block cipher)  Zerteilung der Nachricht in Blöcke fester Größe (z.B. 128 Bit)  Blöcke werden jeweils komplett verschlüsselt  Unvollständige Blöcke werden mit Füll-Bits aufgefüllt (padding)  Stromverschlüsselung (stream cipher)  Zeichenweise Verarbeitung  Besonders für Echtzeitübertragungen geeignet Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 34 Verschlüsselugsmethoden Symmetrische Algorithmen Quelle: Laudon/Laudon/Schoder (2016), Abbildung 15.8 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 35 Verschlüsselugsmethoden Asymmetrische Algorithmen  Zwei Schlüssel: Der Schlüssel K1 wird zum Verschlüsseln und der Schlüssel K2 wird zum Entschlüsseln verwendet  EK1(M) = C  DK2(C) = M  DK2 (EK1 (M)) = M  Auch als „Public-Key-Kryptographie“ bezeichnet  Jede Partei hat einen sogenannten Public- und einen Private-Key (später mehr) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 36 Grundprinzipien Security by Obscurity  Kontrovers diskutiertes Design- und Verhaltensprinzip  Ziel: Sicherheit erhöhen durch Geheimhaltung interner Strukturen  Beispiele:  „Stille“ Firewalls  Obfuskierte Software  Kryptographische Verfahren in Mobilfunk und Digital Rights Management (DRM)  Ein Verfahren selbst ausdenken und implementieren + geheim halten  Im Bereich der Kryptographie meist eher eine schlechte Idee  Externe Experten und Wissenschaftler haben keine Gelegenheit, kryptographische Verfahren zu untersuchen  Angreifer versuchen dennoch diese Verfahren zu brechen  „The enemy knows the system” - Claude Shannon Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 37 Grundprinzipien Kerckhoffs‘ Prinzip  1883 von Auguste Kerckhoffs in La cryptographie militaire gefordert  Das System darf keine Geheimhaltung erfordern  Gemeint ist damit: Die Sicherheit eines kryptographischen Verfahrens darf ausschließlich von der Geheimhaltung der verwendeten Schlüssel abhängen und nicht von der Geheimhaltung der Algorithmen für Ver- und Entschlüsselung. Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 38 Grundprinzipien Beispiel für die Verletzung von Kerckhoffs‘ Prinzip / für schlechte Security by Obscurity  \"Bochumer Forscher knacken Satellitentelefonie“, 07.02.2012  Benedikt Driessen, Ralf Hund, Carsten Willems, Christof Paar und Thorsten Holz vom Horst-Goertz-Institut für IT-Sicherheit der Ruhr-Universität Bochum (RUB)  GMR-1-Standard  Reverse-Engineering eines Software-Updates für ein Satellitentelefon  Technik für ~2.000 EUR benötigt ca. 30 Minuten zur Entzifferung  Hersteller und Betreiber wiegeln ab  https://www.spiegel.de/netzwelt/web/abgehoert-bochumer-forscher-knacken- satellitentelefonie-a-813740.html Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 39 Kryptoanalyse Verschiedene Analysemethoden und Angriffstechniken  Ciphertext-Only-Angriff  Der Angreifer hat nur eine begrenzte Menge Chiffretext und versucht daraus den Klartext zu entziffern  Known-Plaintext-Angriff (KPA)  Kenntnis von Chiffretext und dazu gehörendem Klartext  Chosen-Plaintext-Angriff (CPA)  Der Angreifer kann beliebigen Klartext in Chiffretext wandeln (z.B. bei Public-Key-Systemen)  Chosen-Ciphertext-Angriff (CCA)  Beliebiger Chiffretext kann in Klartext entschlüsselt werden Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 40 Kryptoanalyse Weitere Analysemethoden und Angriffstechniken  Brute-Force-Angriff und Wörterbuchangriff  „Stumpfes“ Durchprobieren aller in Frage kommender Passwörter/Schlüssel  Durchprobieren eines generierten Wörterbuchs mit/ohne Anpassungen/Permutationen  Man-In-The-Middle-Angriff  Dem Angreifer gelingt es, sich zwischen zwei Kommunikationspartnern zu positionieren und deren Nachrichten mitzulesen oder zu verändern  Side-Channel-Angriff  Entzifferung durch Analyse/Manipulation anderer Parameter (z.B. Timing Attack, Differential Power Analysis oder TEMPEST)  Gezielte Interaktion mit dem System  Rubber-hose Cryptanalytics und andere nicht-technische Aktionen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 41 Sicherheit eines kryptographischen Verfahrens Sicherheitskriterien  Ein Verfahren kann als sicher betrachtet werden, wenn  Der finanzielle Aufwand für die Entzifferung den Wert der verschlüsselten Informationen übersteigt  Die zur Entzifferung nötige Zeit die benötigte Geheimhaltungszeit übersteigt  Der Chiffretext kleiner ist, als der zum Entziffern mindestens nötige Umfang (Stichworte: Berechnungskomplexität, Speicherplatzbedarf, Datenkomplexität)  Allgemeines Kriterium für uneingeschränkte Sicherheit  Klartext kann selbst dann nicht entziffert werden, wenn Chiffretext in beliebiger Menge vorhanden ist oder erzeugt werden kann und die Ressourcen des Angreifers unendlich groß sind. Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 42 Sicherheit eines kryptographischen Verfahrens  Kryptographische Verfahren müssen verschiedene Sicherheitsziele erfüllen  z.B. Non-Malleable (nicht verformbar): Änderungen am Chiffretext führen nicht zu sinnvollen Änderungen im Klartext (Kontoverbindung kann nicht geändert werden)  Ein formaler, also \"strikter\" Sicherheitsbeweis ist nur selten möglich.  Problematik ist angelehnt an Korrektheit und Komplexitätstheorie  Aussagen zur Sicherheit basieren auf verschiedenen Angriffs- und Sicherheitsmodellen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 43 Kryptographische Protokolle Schlüsselsicherheit  Wenn ein Verfahren selbst sicher ist und Kerkhoff's Prinzip berücksichtigt wird, gilt die Frage nach der Sicherheit der verwendeten Schlüssel oder Passwörter  Angreifer können probieren und damit erraten  Je länger die Schlüssel, desto geringer die Erfolgswahrscheinlichkeit  Beispiel: 56 Bit langer DES-Schlüssel = 256 Möglichkeiten ≈ 7 ∙ 1016  1998 in zwei Tagen geknackt durch EFF mit Deep Crack für <250.000 USD  Benötigt im Mittel 4,5 Tage, Worst Case 9 Tage, bei 90 Milliarden (9*1010) Schlüsseln pro Sekunde  Bereits 1999 mit distributed.net bei 22 Stunden (Foto: Matt Crypto/Wikipedia) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 44 Kryptographische Protokolle Schlüsselsicherheit  Fortsetzung des Beispiels:  4,5 Tage für 56 Bit Schlüssel  Vergrößern des Schlüssels auf 100 Bit  Aufgabe: Schätzen Sie ab! Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 45 Kryptographische Protokolle Schlüsselsicherheit  Fortsetzung des Beispiels:  4,5 Tage für 56 Bit Schlüssel  100 Bit = 2100 Möglichkeiten ≈ 1,3 ∙ 1030 Schlüssel  Bei 9 ∙ 1010 Schlüsseln pro Sekunde liegt der Average Case bei 7 ∙ 1018 Sekunden ≈ 2 ∙ 1011 Jahre (100 Milliarden Jahre)  Zum Vergleich: Die Sonne wird noch ca. 5 Milliarden Jahre scheinen  Achtung bei Überführung Passwort -> Schlüssel. Aufgabe: Warum? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 46 Kryptographische Protokolle  1024 Bit = 21024 Mögliche Schlüssel 0110100110000011110000100111000000110010001101101001000011000100110010000001111 1001001101001110001001110111111011100101000011110010101101110000100011101001110 0000110111010100101110111101101100101011001111101010010000110100000010000110000 0101011111010011000111111011110110011001010010000010110111111100111100001111110 0000011100101001001001011000110100000100010101110111000100010110001001101000111 0001100111100101110010100100001100101110010011100000000010100011000100101011011 1001101000101111001001011110100101010010110000011101101010110001111111100011110 0100011110111110000001010001100011101000011111011100001100001111101010000101001 0111011010101010100010010011101000111111100010010111111001011100111100011000011 1010100111111111000111011010101001100101100011100011011100101100111111000001001 0111111101101101001100100010000011011111101000001101010100000010101110011011001 0011111111100100100010001001110100110100100110001001111100010010110101101000100 01110011101000000001111101010101010100110100111011101000000010100010000011110  SECRETSECRET = 12 Zeichen = 12 Byte = 96 Bit 0101001101000101010000110101001001000101010101000101001101000101010000110101001 00100010101010100 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 47 Kryptographische Protokolle  Aufgrund der unterschiedlichen mathematischen Konzepte unterscheiden sich die Schlüssellängen erheblich  Zur Vereinheitlichung wurde das Konzept des Sicherheitsniveaus entwickelt:  „Ein kryptographisches System bietet Sicherheitsniveau λ , wenn erwartet werden kann, dass ein erfolgreicher Angriff etwa eine Komplexität von 2^λ besitzt.“ übersetzt aus Arjen K. Lenstra, Key Lengths—Contribution to The Handbook of Information Security  Basierend auf dieser Annahme gibt es verschiedene Überlegungen, wie das Sicherheitsniveau abzuschätzen ist (siehe etwa keylength.com für einen Vergleich von Methoden)  Komplexität typischerweise gemessen in Bit  Größenordnungen (nach ECRYPT-CSA Report 2018): Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 48 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Ein jahrhunderte, sogar jahrtausende alter Kampf zwischen Verschlüsslern und Entschlüsslern  Erste Beschreibungen von Geheimschriften bei Herodot vor ca. 2500 Jahren in den Historien über den Krieg zwischen Griechenland und Persien:  Nachrichten im Holz der Wachstafeln versteckt  Skytale: Das älteste bekannte (von den Spartanern militärisch genutzte) kryptographische Verfahren. Man wickelt ein Textband um einen Stock und schreibt dann zeilenweise.  Aufgabe: Probieren Sie Skytale selbst aus  Auch das Kamasutra (ca. 1700 Jahre alt) enthält einen Vorschlag zur Verschlüsselung (Buchstabenersetzung) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 49 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Auch Julius Caesar beschrieb vor grob 2000 Jahren im Gallischen Krieg ein einfaches Verschlüsselungsverfahren: Caesar-Verschiebung oder ROT-3, bei der die Buchstaben einfach zeichenweise drei Positionen weiter verschoben werden Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 50 Historischer Überblick Aufgabe: Verschlüsseln Sie einen kurzen Text (ca. ein Satz, beliebig gewählt) ROT-3. Vergleichen Sie mit den Texten Ihrer Sitznachbarn. Was fällt Ihnen auf? Regeln / Tipps:  A → D, B → E, C → F, … , X → A, Y → B, Z → C  Alles außer den 26 Buchstaben des Alphabets (Umlaute, Satzzeichen, ß, Leerzeichen, …) bleibt der Einfachheit halber unangetastet.  Groß-/Kleinschreibung wird ignoriert  Wer nicht händisch verschlüsseln will, findet zahlreiche Webseiten im Internet unter dem Stichwort „caesar cipher“ Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 51 Historischer Überblick Aufgabe: Verschlüsseln Sie einen kurzen Text (ca. ein Satz, beliebig gewählt) ROT-3. Vergleichen Sie mit den Texten Ihrer Sitznachbarn. Was fällt Ihnen auf? Ergebnisse: Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 52 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Einfache Ersetzungsverfahren dominierten das erste Jahrtausend…  Bis arabische Kryptoanalytiker in Verbindung aus Sprachwissenschaften, Statistik und religiöser Hingabe (z.B. im 9. Jahrhundert der „Philosoph der Araber“) statistische Auffälligkeiten und Verteilungsmuster in Sprache und Chiffraten entdeckten… Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 53 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Europa war mit diesen Erkenntnissen später dran. Vielleicht lernte man das Wissen aus dem Orient oder entdeckte es neu.  Als erster großer europäischer Kryptoanalytiker gilt der Italiener Giovanni Soro (Anfang des 16. Jahrhunderts)  Ende des 16. Jahrhunderts stieß Blaise de Vigenère auf die Arbeiten des Italieners Leon Battista Alberti aus dem 15. Jahrhundert bzgl. einer neuartigen Verschlüsselungstechnik  Die Zeichenersetzung geschieht nun über mehrere Geheimtextalphabete, zugeordnet über ein Schlüsselwort  Das Verfahren wurde die nächsten 200 Jahre jedoch ignoriert…  Stattdessen wurde weiterhin (17. Jahrhundert!) einfache Ersetzung verwendet, aber zusätzlich mit homophoner Variante (mehrere Chiffrat-Zeichen für besonders häufige Buchstaben) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 54 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Immer wieder konnten Verfahren lange Zeit nicht geknackt werden, wie die Große Chiffre der Rossignols aus Frankreich (17. Jahrhundert, geknackt erst im 19. Jahrhundert)  Spätestens im 17. Jahrhundert hatten alle Europäischen Mächte in sogenannten Schwarzen Kammern ihre Kryptoexperten  Charles Babbage knackte 1854 die bis dahin sichere Vigenère- Verschlüsselung, veröffentlichte dies aber nicht. Der Preusse Friedrich Wilhelm Kasiski knackt unabhängig 1863 und veröffentlicht.  Es folgte ein neues Zeitalter durch Elektrizität, Telefon/Telegraf, Funk, Computer/Rechenmaschinen, die Weltkriege, … Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 55 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  The Beale Papers von 1885/1822  Bis heute ungelöst!  Aber evtl. Hoax Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 56 Historischer Überblick Eine beeindruckende Geschichte knapp zusammengefasst  Anfang des 20. Jahrhunderts erfanden die Amerikaner das grundsätzlich sichere One-Time-Pad  Arthur Scherbius entwickelte die Enigma zur Nutzung durch Wirtschaft und Militär, polnische und englische Kryptologen knackten die Enigma (Stichworte Bletchley Park, „Bomben“, Maria Rejewski, Alan Turing, …)  Die Amerikaner nutzten vormals „minderwertige“ Navajo-Indianer plötzlich als kriegswichtiges Mittel zur codierten Kommunikation: Als Codesprecher…  DES (1976), MD5 (1991), AES (2000) und andere betreten die Bühne  Und spätestens seit der Erfindung der Public-Key-Kryptographie (1976) ist Verschlüsselung massentauglich geworden Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 57 Ziviler Nutzen der Kryptographie  Wirtschaft und Privatpersonen haben letztlich das gleiche Interesse wie Militär und Politik/Regierung Nachrichten sicher und insbesondere vertraulich übertragen zu können  Durch günstigere Hardware und frei verfügbare Software ist Kryptographie spätestens seit einigen Jahren nahezu allgegenwärtig  Stichwort: ROT-13 in der Windows-Registry ;-) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 58 Strafbare Nutzung der Kryptographie Beispiel: Ursprünge des Phänomens Ransomware  AIDS TROJAN DISK bereits von 1989: verschlüsselt Dateinamen auf C:\\ und fordert 189$ Lösegeld  TROJ_PGPCODER.A von 2005 verschlüsselt ebenfalls und zwar asymmetrisch und fordert dann Lösegeld für den privaten Schlüssel  Stichwort Cryptovirology (Ursprung in der akademischen Welt) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 59 Klassische Chiffrierverfahren Grundüberlegungen  Transpositionschiffre: Der Chiffretext wird durch eine Permutation von Klartextzeichen erzeugt (Die Positionen der Zeichen im Klartext wechseln untereinander)  Substitutionschiffre: Die Position der Zeichen ändert sich nicht, aber jedes Klartextzeichen wird durch ein Chiffrezeichen ersetzt  Monoalphabetisch: Gleichbleibende Klartextzeichen werden auf gleichbleibende Chiffrezeichen abgebildet  Polyalphabetisch: das Gegenteil. An unterschiedlichen Stellen des Klartexts werden völlig unterschiedliche Chiffrealphabete verwendet Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 60 Klassische Chiffrierverfahren Aufgabe:  Wie viele Schlüssel gibt es bei einer Verschiebechiffre (26 Zeichen a-z)?  Wie viele monoalphabetische Chiffren gibt es bei diesem Zeichenvorrat?  Wie viele und welche monoalphabetische Chiffren gibt es bei Binärdaten? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 61 Klassische Chiffrierverfahren Polyalphabetische Chiffren / Homophone Chiffren  Einem Klartextzeichen werden einfach mehrere Chiffrezeichen zugeordnet  Homophon: ein festes Alphabet mit mehr als einem Zeichen pro Klartextbuchstabe  Polyalphabetisch: mehrere eigenständige Alphabete  Ziel: Jedes Zeichen soll im Chiffretext gleich oft vorkommen, um statistische Angriffe zu verhindern  Problem: Kryptoanalyse über Häufigkeit von Bigrammen und Trigrammen möglich Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 62 Klassische Chiffrierverfahren Vigenère-Chiffre  Polyalphabetische Verschiebechiffre  Entwickelt im 16. Jahrhundert. Benannt nach dem Franzosen Blaise de Vigenère (nicht der ursprüngliche Erfinder)  Ein Codewort definiert über die Anzahl seiner Zeichen die Anzahl der verwendeten Alphabete und welche verwendet werden  Die einzelnen Alphabete führen jeweils eine Caesar-Verschiebung durch  Es reicht damit von einer einfachen Caesar-Chiffre bis zum (absolut) sicheren Verfahren One-Time-Pad Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 63 Klassische Chiffrierverfahren Vigenère-Chiffre  Klartext: quiteshort  Schlüssel: hellohello  Chiffre: xyteszlzch  Links: Schlüssel  Oben: Klartext  Aufgabe: Verschlüsseln Sie das Wort „Informationssicherheit“ mit selbstgewähltem Schlüssel Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 64 Klassische Chiffrierverfahren Vigenère-Chiffre  Gebrochen 1854 von Babbage und 1863 von Kasiski  Ziel: Finden der Schlüsselwortlänge k. Danach k einzelne Caesar-Chiffren knacken  Zum Testen der Schlüssellängen werden verwendet:  Kasiski-Test  Friedman-Test Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 65 Klassische Chiffrierverfahren Grundlage: XOR  Exklusives Oder  XOR-Verknüpfung in der Aussagenlogik  0 XOR 0 = 0  1 XOR 1 = 0  1 XOR 0 = 1  0 XOR 1 = 1  Dies ist für die Kryptographie interessant: Warum? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 66 Klassische Chiffrierverfahren One-Time-Pad  1918 von Gilbert Vernam und von Joseph O. Mauborgne entwickelt  Idee: Verwendung eines Schlüssels, der (mindestens) so lang ist wie der Klartext und dann zeichenweise XOR-Verknüpfung  Das Verfahren läuft symmetrisch und ist eine Stromchiffre  Es ist im Kern nichts anderes als die Vigenère-Chiffre. Warum?  Das Verfahren ist – richtig verwendet – beweisbar sicher. Warum? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 67 Klassische Chiffrierverfahren One-Time-Pad  Richtig verwendet ist das Verfahren „perfekt“ und kann auch mit noch so hohem Aufwand nicht gebrochen werden  Dazu müssen folgende Bedingungen erfüllt sein:  Der Schlüssel ist so lang wie die Nachricht  Er ist gleichverteilt vollständig zufällig  Er bleibt geheim  Er wird nicht wiederverwendet (auch nicht in Teilen)  Es gibt dann  So viele Schlüssel wie mögliche Chiffrate  Für jedes Paar Klartext ↔ Chiffretext einen passenden Schlüssel  p(M|C) = p(M)  p(M C) = p(M) * p(C)∧ Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 68 Klassische Chiffrierverfahren One-Time-Pad  Egal wie lang der vorliegende Chiffretext ist, gibt es keine Möglichkeit daraus den Klartext abzuleiten  Negatives Extrembeispiel:  Schlüsselstrom aus lauter 1en: Invertierung  Schlüsselstrom aus lauter 0en: Klartext = Chiffrat  Echte Zufallszahlen sind elementarer Bestandteil des Verfahrens Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 69 Zufallszahlen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 70 Zufallszahlen Was ist Zufall und warum ist guter Zufall so wichtig?  Was ist Zufall aus Sicht der Informatik?  „Eine Zahlenfolge (an) mit ai {0,1} heißt (echte) Zufallsbitfolge, wenn die Werte 0 ∈ und 1 jeweils mit Wahrscheinlichkeit ½ vorkommen und wenn es keine Möglichkeit gibt, aus der Kenntnis eines beliebig langen Anfangsstücks der Folge Informationen über den Rest der Folge abzuleiten.“ - Definition nach „Angewandte Kryptographie“, Prof. Ertel, S. 52  Wie kann ein Computer Zufall erzeugen, wenn er doch ausschließlich deterministische Rechenvorschriften ausführen kann? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 71 Zufallszahlen Was ist Zufall und warum ist guter Zufall so wichtig? → Pseudozufallszahlengeneratoren (Pseudorandom Number Generators, PRNG)  Kein wirklicher Zufall, sondern eine deterministische Rechenanweisung, deren Ausgabe diversen statistischen Tests genügt  Oft: Lineare Kongruenzgeneratoren der Form a*xi + b mod m, x=>0, x0 ist ein Initialwert und wird auch als Seed bezeichnet  Je nach Wahl der Konstanten a, b und m sehr gute statistische Eigenschaften  Problem: Linear → Konstanten können durch Aufstellen linearer Gleichungssysteme berechnet werden (Known-Plaintext-Angriff)  PRNGs sind deshalb nicht für kryptographische Anwendungen geeignet. Welche Möglichkeiten bleiben? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 72 Zufallszahlen Was ist Zufall und warum ist guter Zufall so wichtig?  Echte Zufallszahlengeneratoren (True Random Number Generators, TRNG)  Münzwurf, Würfel  Abweichungen in der Mausbewegung, Verzögerung beim Tastaturanschlag  thermisches Rauschen, radioaktiver Zerfall von Atomen, kosmische Hintergrundstrahlung, … → Problem: Hardwarekomponenten sind teuer und nicht weit verbreitet, Ausgabegeschwindigkeit oft begrenzt  Kryptographisch sichere Pseudozufallszahlengeneratoren (Cryptographically Secure Pseudorandom Number Generators, CSPRNG)  Technisch wie ein PRNG, aber unvorhersagbar  Aus einer Reihe von n Bits kann nicht mit mehr als 50% Wahrscheinlichkeit bestimmt werden, wie das nächste Bit lautet, egal wie groß n ist  Das gilt auch für die Rückrichtung (keine Berechenbarkeit vorhergegangener Bits)  Zufall wird für viele Einsatzzwecke benötigt, Unvorhersagbarkeit ist aber nur in der Kryptographie notwendig Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 73 Beginn der Ära der modernen Kryptographie Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 75 Beginn der Ära der modernen Kryptographie  Claude Elwood Shannon (USA, 1916-2001) war Mathematiker, Elektrotechniker und Begründer der Informationstheorie  Und genialer Bastler!  Communication Theory of Secrecy Systems (1949)  http://netlab.cs.ucla.edu/wiki/files/shannon1949.pdf  Intensive Orientierung an mathematischen Aspekten der Kryptographie  Begründung einer Phase der gemeinsamen wissenschaftlichen Arbeit an Kryptoverfahren  “To make the problem mathematically tractable we shall assume that the enemy knows the system being used.”  Wichtige Forderungen für die Ableitung des Geheimtextes aus Klartext:  Konfusion  Diffusion  Verwendung von Blockchiffren, um beides zu erreichen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 76 Data Encryption Standard (DES) Hintergrund  Anfang der 1970er Jahre wollte in den USA das National Bureau of Standards (NBS, heute NIST) ein sicheres Kryptoverfahren für die Kommunikation zwischen Behörden und Unternehmen (also nicht-militärisch) schaffen  Kerkhoffs’ Prinzip sollte hier Anwendung finden  Die erste öffentliche Ausschreibung 1973 blieb ergebnislos, die zweite 1974 führte zu einer Einreichung von IBM  Horst Feistel hatte einige Jahre zuvor “Lucifer” entwickelt, welches nun in verbesserter Form als DES vom NBS akzeptiert wurde  Die National Security Agency (NSA) war an der Entwicklung beteiligt (Verbesserung, aber auch Limitierung der Schlüssellänge)  Bis in die 90er-Jahre einer der wichtigsten Standards Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 77 Data Encryption Standard (DES) Hintergrund  DES ist ein symmetrisches Verfahren  Gut in Hardware implementierbar  Blockgröße 64 Bit  Durch Schlüssellänge von 56 Bit (64 – 8 Bit Parität) schon seit Jahren nicht mehr ausreichend sicher  Als Triple-DES jedoch auch heute noch sehr weit verbreitet (z.B. bei Banktransaktionen)  Keine größeren mathematischen Schwächen, deshalb ein gutes Beispiel dafür, wie moderne Blockchiffren aufgebaut sind → mehr Details: Übung Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 78 Data Encryption Standard (DES) 3DES  Verschlüsseln  C = DESK3(DES-1K2(DESK1(M))) oder C = DESK3(DESK2(DES K1(M)))  Entschlüsseln  M = DES-1 K1(DESK2(DES-1K3(C))) bzw. M = DES-1K1(DES -1K2(DES-1K3(C)))  Drei Schlüsseloptionen:  K1 != K2 != K3 (3 x 56 = 168 Bit)  K3 = K1 != K2  K1 = K2 = K3 → führt bei Variante 1 effektiv zu DES: Abwärtskompatibilität  Meet-In-The-Middle-Angriff: Nicht etwa 56*3=168 Bit Sicherheitsniveau sondern nur 112 Bit  NIST: Schlüsseloption 1 sicher bis 2030  http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 79 Advanced Encryption Standard (AES) Hintergrund  Ebenfalls symmetrisches Kryptoverfahren  Der vom NIST seit 2000 ausgewählte Nachfolger für DES/3DES  15 Vorschläge wurden 1998 abgegeben  5 davon erfüllten die vom NIST gesetzten Anforderungen  Serpent  MARS  Rijndael  RC6  Twofish  Gewinner: Entwickelt von Joan Daemen und Vincent Rijmen  Wird daher auch Rijndael-Algorithmus genannt  Sehr sicheres Verfahren, theoretisch anwendbare aber praktisch nicht relevante Angriffsmöglichkeiten  In USA für höchste Geheimhaltungsstufe freigegeben  Kann kostenfrei verwendet werden Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 80 Advanced Encryption Standard (AES) Hintergrund  Blockgröße: 128 Bit (ursprünglich auch 192 und 256 Bit)  Schlüssellänge: Variabel; 128, 192 oder 256 Bit  AES-128, AES-192 und AES-256  Ist effizient in Hardware implementierbar  Wird auch in Smartcards verwendet  Verwendung: WPA2, SSH, IPSec, SRTP, Skype, … Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 81 Betriebsmodi für Blockverschlüsselungen  Wie verschlüsselt eine Blockchiffre die einzelnen Blöcke? Blockweise! ;-)  DES: je 64bit pro Block  AES: je 128bit  Betriebsmodi sind ein Weg, um Daten verschlüsseln zu können, die größer sind als ein Block Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 82 Betriebsmodi für Blockverschlüsselungen Electronic Code Block Mode (ECB Mode)  Verschlüsselt jeden Block unabhängig voneinander mit demselben Schlüssel Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 83 Betriebsmodi für Blockverschlüsselungen Electronic Code Block Mode (ECB Mode)  Was ist das Problem bei blockweise unabhängiger Verschlüsselung?  Monoalphabetische Verschlüsselung z.B. mit dem Alphabet 264  Statistische Auffälligkeiten  Tausch- und Ersetzbarkeit einzelner Blöcke  Quelle des Fotos: en:User:Lunkwill/Wikipedia, basierend auf einem Bild von Larry Ewing, lewing@isc.tamu.edu, erstellt mit der Software The Gimp Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 85 Betriebsmodi für Blockverschlüsselungen Cipher Block Chaining Mode (CBC Mode)  XOR-Verknüpfung eines Blocks mit dem Chiffrat des Vorgängerblocks  Beschädigter Block macht lediglich zwei Blöcke unbrauchbar  Vermeidung von Mustern und gleichen Blöcken Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 86 Betriebsmodi für Blockverschlüsselungen Cipher Feedback Mode (CFB Mode)  Ergibt eine Stromchiffre Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 87 Betriebsmodi für Blockverschlüsselungen Output Feedback Mode (OFB Mode)  Ergibt eine Stromchiffre Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 88 Betriebsmodi für Blockverschlüsselungen Counter Mode (CTR Mode)  Ergibt eine Stromchiffre, ähnlich wie OFB, aber statt Feedback ein aufsteigender Zähler Darauf aufbauend: Galois/Counter Mode (GCM)  Bietet neben Verschlüsselung zusätzlich Authentifikation Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 89 Public-Key-Kryptographie Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 90 Public-Key-Kryptographie Ein Wort: Fantastisch! Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 91 Public-Key-Kryptographie Alle bisherigen Verfahren haben ein Problem  Alice und Bob müssen zunächst einen geheimen Schlüssel generieren und austauschen  Im Falle von One-Time-Pad sind die Generierung und der Austausch für lange Nachrichten sehr aufwändig  Alice und Bob senden im Normalfall räumlich getrennt und kommunizieren über einen unsicheren Kanal  Das Problem ist also ein sicherer Schlüsselaustausch über diesen unsicheren Kanal  Bisher wurden daher Codebücher erzeugt und verteilt (Beispiel: Enigma) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 92 Public-Key-Kryptographie Die Lösung  Alice sendet Bob eine verschlüsselte Nachricht und verwendet dazu dessen Public Key. Bob entschlüsselt die Nachricht mit seinem geheim gehaltenen Private Key  EPB(M) = C  DSB (C) = M  DSB(EPB(M)) = M  Verschlüsselung und Entschlüsselung hängen mathematisch voneinander ab  Der eine Weg ermöglicht jedoch praktisch nicht den anderen (Einwegfunktionen) E k pub , B ( M )= C D k p riv ,B (C )= M A B EPB DSB M MEPB(M) Alternative Schreibweise Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 93 Public-Key-Kryptographie  Die Lösung  Quelle: Laudon/Laudon/Schoder (2015), Abbildung 15.9 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 94 Public-Key-Kryptographie Grundlage: Einwegfunktion  y = f(x), ist mathematisch effizient zu berechnen, während  x = f-1(y) nur mit sehr viel Rechenleistung und hohem Zeitaufwand berechnet werden kann.  Beispiel:  Eine Telefonnummer zu einem Namen kann mit Hilfe eines Telefonbuchs sehr schnell gefunden werden, ein Name zu einer Telefonnummer aber nur mit viel Aufwand (Überprüfen jedes einzelnen Eintrags im Telefonbuch).  Sonderfall Falltürfunktion (Trapdoor): Die Umkehrfuntion ist dann leicht, wenn man ein Geheimnis kennt („den geheimen Schlüssel zur Falltür“). Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 95 Public-Key-Kryptographie Arten von Einwegfunktionen  Falltürfunktionen für asymmetrische Kryptographie werden im Wesentlichen aus einer von drei mathematischen Problemklassen abgeleitet:  Faktorisierung großer Zahlen  Diskreter Logarithmus  Elliptische Kurven (hier nicht behandelt) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 96 Public-Key-Kryptographie Das RSA-Verfahren  Entwickelt 1977 in USA am MIT von Rivest, Shamir und Adleman  Das Patent ist 2000 abgelaufen  Ende der 1990er wurde bekannt, das die Communications-Electronics Security Group (CESG) aus England Anfang der 1970er ähnliche Entdeckungen gemacht hat  Idee:  Alice und Bob erzeugen jeweils ein Paar aus zueinander gehörendem öffentlichem und privatem Schlüssel  Alice und Bob tauschen jeweils ihren öffentlichen Schlüssel aus  Wenn Alice eine Nachricht an Bob schickt, verwendet sie dazu Bobs öffentlichen Schlüssel  Zum Signieren verwendet Alice ihren privaten Schlüssel Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 97 Public-Key-Kryptographie Das RSA-Verfahren: Schlüsselerzeugung  Wähle per Zufall zwei große Primzahlen p != q (je ca. 1024 Bit)  Berechne N = p * q (RSA-Modulus)  Berechne φ(N) = (p - 1) * (q - 1)  Wähle eine Zahl e, mit  1 < e < φ(N) und  ggT(e, φ(N)) = 1 → relativ prim / teilerfremd  Berechne d = e -1 mod φ(N) (z.B. mit dem erweiterten Euklidischen Algorithmus)  Öffentlicher Schlüssel: P=(e, N)  Privater Schlüssel: S=(d,N) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 98 Public-Key-Kryptographie Das RSA-Verfahren: Anwendung  Klartext:  M = Dezimalzahl aus ℤ  Mit 0 < m < N  Chiffrierung:  C = E(M) = Me mod N  Entschlüsselung:  M = D(C) = Cd mod N Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 99 Public-Key-Kryptographie RSA-Sicherheit: Wir bleiben an der Oberfläche  Die Details werden sehr schnell mathematisch und sehr komplex  z.B.: Warum taucht da auf einmal φ(N) auf?  Das bezieht sich auch auf die Beurteilung der Sicherheit und die bereits entdeckten Schwachstellen  Aber die wesentliche Überlegung zur Sicherheit ist recht einfach…  Primfaktorzerlegung ist bis heute schwer berechenbar (exponentiell)  N = p x q (RSA-Modul)  Aufgabe:  Zerlegen Sie 31 in seine Primfaktoren  Zerlegen Sie 1024 in seine Primfaktoren  Zerlegen Sie 10, dann 100, dann 1000, dann 5000 in seine Primfaktoren  Und nun 98756 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 100 Public-Key-Kryptographie RSA-Sicherheit: Wir bleiben an der Oberfläche Es gibt etwa 𝜋(n) = n/(ln n) Primzahlen im Intervall [1,n] (Quelle: Prof. Ertel, „Angewandte Kryptographie“)  𝜋(2^ 512) ≈ 3,8 x 1015  Etwa so viele Primzahlen wie Sterne in 10.000 Milchstraßen (je 1-2*10 11)  Suche z.B. über das Sieb des Eratosthenes  Es gab in der Vergangenheit mehrere Wettbewerbe zum Faktorisieren großer Primzahlen  1994 RSA-129  2005 RSA-640  RSA-768 mit 232 Dezimalstellen, im Jahre 2009 auf 2000 2 GHz-CPUs mit drei Jahren Laufzeit geknackt  Die Sicherheit von RSA hängt damit (mindestens) von der Wahl großer Primzahlen ab  Empfohlen: Mindestens 2048 Bit Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 101 Public-Key-Kryptographie RSA-Signaturverfahren  RSA kann auch zum Signieren von Nachrichten verwendet werden  Alice bildet dazu den Hash der zu signierenden Nachricht  Sie „entschlüsselt“ dann den Hash mit ihrem privaten Schlüssel und sendet Nachricht+Hash an Bob  Bob „verschlüsselt“ den Hash mit dem öffentlichen Schlüssel von Alice, berechnet selbst den Hash der Nachricht und prüft auf Gleichheit Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 102 Public-Key-Kryptographie RSA: Performance  RSA ist vergleichsweise aufwändig  Primzahlen finden, bzw. Zahlen auf Primalität testen  Berechnungen wie Me mod N erfordern viele Rechenschritte  RSA-Hardwareimplementierungen ca. 1000 mal langsamer als DES- Hardwareimplementierungen (Quelle: Prof. Ertel, „Angewandte Kryptographie“) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 103 Public-Key-Kryptographie Schlüsselaustausch  Der Schlüsseltausch bleibt weiterhin eine Herausforderung  Codebücher  Persönliche Übergabe  Zentrales Trustcenter, welches Alice und Bob einen (symmetrischen) Sitzungsschlüssel zuweist  …  Man-In-The-Middle-Angriffe sind ein grundsätzliches Problem in allen Kommunikationskanälen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 104 Public-Key-Kryptographie Schlüsselaustausch: Man-in-the-Middle-Angriff A BEPM EPB M M A M B PBPM M Frage: was fehlt in der unteren Grafik bisher? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 105 Public-Key-Kryptographie Das Interlock Protocol gegen MitM-Attacken  Entwickelt von Rivest und Shamir  Alice verschlüsselt ihre Nachricht an Bob, schickt aber nur die erste Hälfte  Bob verschlüsselt seine Nachricht an Alice und verschickt auch nur die erste Hälfte  Alice sendet jetzt die zweite Hälfte  Bob sendet dann auch seine zweite Hälfte  Idee: Mallory kann halbe Nachrichten nicht entschlüsseln und würde daher auffallen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 106 Public-Key-Kryptographie Diffie-Hellman-Schlüsselaustausch (DHKE = D-H-Key-Exchange)  Weitere fantastische Entwicklung von 1976  Mit diesem Verfahren können Alice und Bob über einen unsicheren Kanal einen geheimen Sitzungsschlüssel für folgende symmetrische Verfahren aushandeln  Auch dieses Verfahren ist zwar mathematisch von einem Angreifer lösbar, aber aufgrund des Rechenaufwands praktisch unlösbar  Und auch dieses Verfahren ist in seiner Basisform anfällig gegen MITM- Angriffe und muss daher z.B. mit digitalen Signaturen zusätzlich abgesichert werden Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 108 Diffie-Hellman-Schlüsselaustausch Vorbereitung:  Alice und Bob handeln eine große Primzahl (n) und eine weitere Zahl (g) aus  Alice wählt im Geheimen a mit 2 ≤ a ≤ n-2  Bob wählt im Geheimen b mit 2 ≤ b ≤ n-2 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 109 Diffie-Hellman-Schlüsselaustausch  Alice berechnet A = ga mod n und sendet A an Bob  Bob berechnet B = gb mod n und sendet B an Alice  Alice berechnet: KA = Ba mod n  Bob berechnet: KB = Ab mod n  Es gilt KA = KB  Warum? → Übung! Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 110 Hashing # ? Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 111 Hashing Grundidee  Hashing-Verfahren sind als „Fingerabdruck“ allgegenwärtiger Bestandteil z.B. der IT- Forensik  Es handelt sich um Einwegfunktionen, welche beliebig langen Input auf Output fester Länge abbilden  MD5 z.B. 128 Bit lang → Es gibt „nur“ 2128 MD5-Hashes  Stark vereinfachter Ablauf:  Rekursiv wird der Input blockweise verarbeitet: Hash aus aktuellem Block gekoppelt mit dem vorherigen Hash → kleine Änderung an Eingabe ändert Ausgabe massiv (Avalanche) $ echo \"hello\" | md5 b1946ac92492d2347c6235b4d2611184 $ echo \"hallo\" | md5 aee97cb3ad288ef0add6c6b5b5fae48a Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 112 Hashing Grundidee Sicherheitsanforderungen an kryptographische Hashfunktionen  Einwegfunktion (preimage resistance)  H(m) ist leicht zu bestimmen, m = H-1(H(m)) kann nicht effizient bestimmt werden  Schwache Kollisionsresistenz (2nd preimage resistance)  m 1 ist fix, m2 mit H(m1)=H(m 2) kann nicht effizient bestimmt werden  Starke Kollisionsresistenz (collision resistance)  m 1 und m2 frei wählbar, können nicht effizient so gewählt werden, dass H(m1)=H(m 2) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 113 Hashing Grundidee  Nicht verwechseln! In der Informatik gibt es Datenstrukturen, die Hashing zur effizienten Datenspeicherung nutzen (hash table / hash map). Hier ist eine Kollision lediglich aus Effizienzgründen unerwünscht, die anderen Sicherheitsanforderungen an kryptographische Hashfunktionen sind hier irrelevant.  Eine gültige Hashfunktion in diesem Kontext wäre es z.B. immer den ersten Buchstaben eines Wortes zu nehmen  In diesem Fall ist weder schwache noch starke Kollisionsresistenz gegeben Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 114 Hashing Hashing als Technik, Passwörter geschützt abzubilden  Allgemein: Hashen geht schnell → schlecht, hilft dem Angreifer  Lösung: H( H( H( H( H(. ....( H( password )))...)))  Verbleibendes Problem: → Alice und Bob benutzen das selbe Passwort → Angriff: Datenbank wird ausgelesen → Angreifer kennt Passwort von Alice und Bob nicht → Angreifer weiß aber, dass es das selbe ist → Angreifer kann Passworthinweise kombinieren ... Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 115 Hashing  So geschehen 2014 bei Adobe... Quelle: xkcd.com Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 116 Hashing Lösung „Salting“ - Grundidee: an jedes Passwort einen zufällig gewählten Wert anhängen  Dazu nötig:  Crptographically Secure Pseudo-Random Number Generator  Speichern von Salt: als zusätzliche Spalte in Datenbank  Nicht schlimm, wenn Angreifer diese beim Angriff auch ausliest → er weiß trotzdem nicht, ob password(Alice) = password(Bob) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 117 Hashing Sicherheit aktueller Verfahren  MD5 gilt nicht mehr als ausreichend sicher  Erste Schwachstellen 1994 gefunden (Bert de Boer und Antoon Bosselaers)  2004 substantielle Fortschritte eines chinesischen Teams  2009 Test der PC-Zeitschrift c’t mit ~35 Minuten Zeit bis zum rechnergestützen Finden einer Kollision  Beispiel für Kollisionen → PC-Übung nächste Woche  SHA-1  Erste Schwächen gefunden und Angriffe beschleunigt  Bisher nur Kollisionsangriffe  2019: Birthday-Near-Collision Attack von Gaëtan Leurent and Thomas Peyrin („To put it in another way: all attacks that are practical on MD5 are now also practical on SHA-1.“) - https://sha-mbles.github.io/  Lösung: Zwei Verfahren parallel verwenden, oder SHA-256 oder SHA-3 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 118 Hashing Brute-Force-Angriffe mit CPU und GPU  CPU (1,7GHz-System, Intel Pentium-M):  DES: ~160.000 Passwörter/Sekunde  FreeBSD MD5: ~4300 P/s  OpenBSD Blowfish: ~256 P/s  NT LM DES: ~2.000.000 P/s  Worst-Case-Laufzeiten für DES mit o.g. CPU:  a-z, 4 Zeichen: 2,8s  a-zA-Z0-9, 4 Zeichen: 92s  a-zA-Z0-9, 6 Zeichen: 99h  a-zA-Z0-9, 8 Zeichen: 43y  GPU-beschleunigtes SHA1-Hashing (oclHashcat, GTX 1070): >1 Milliarde/s Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 119 Hashing Brute-Force-Angriffe mit CPU und GPU  8x Nvidia GTX 1080 Hashcat Benchmarks  Hashtype: MD5 -> Speed.Dev.#*.: 200.3 GH/s  Hashtype: SHA1 -> Speed.Dev.#*.: 68771.0 MH/s  Hashtype: SHA-3(Keccak) -> Speed.Dev.#*.: 6495.6 MH/s  Hashtype: phpass, MD5(Wordpress), MD5(phpBB3), MD5(Joomla) -> Speed.Dev.#*.: 55130.8 kH/s  Hashtype: PBKDF2-HMAC-SHA1 -> Speed.Dev.#*.: 26156.2 kH/s  Hashtype: WPA/WPA2 -> Speed.Dev.#*.: 3177.6 kH/s  Hashtype: NTLM -> Speed.Dev.#*.: 334.0 GH/s  https://gist.github.com/epixoip/a83d38f412b4737e99bbef804a270c40 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 120 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 121 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Grundüberlegungen  Wie können Man-In-The-Middle-Angriffe effektiv und effizient verhindert werden?  Wie kann eine nachweisbare Verbindlichkeit von elektronischen Dokumenten erreicht werden?  Wie kann man Passwort-basierte Authentifizierung verbessern?  Kryptographische Verfahren können bei diesen Herausforderungen helfen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 122 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Message-Authentication-Codes (MAC)  MACs sind ähnlich wie Prüfsummen  Prüfsummen schützen jedoch nur vor Übertragungsfehlern  Angreifer können sowohl die Nachricht als auch die Prüfsumme manipulieren  MACs verwenden zusätzlich einen symmetrischen Schlüssel, um die Authentizität der Nachricht nachzuweisen (nur die Personen, die den Schlüssel kennen, können den MAC erstellen und überprüfen).  Keine Nichtabstreitbarkeit (anders als Signaturen)  Sie werden z.B. in den WLAN-Standards verwendet Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 123 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Definition: Digitale / Elektronische Signatur Pragmatische Definition  Ein digitaler Code, der einer elektronisch übertragenen Nachricht hinzugefügt wird, um ihren Inhalt und den Sender eindeutig zu identifizieren. Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 124 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Definition: Digitale / Elektronische Signatur  (2) ELECTRONIC- The term 'electronic' means relating to technology having electrical, digital, magnetic, wireless, optical, electromagnetic, or similar capabilities.  (4) ELECTRONIC RECORD- The term 'electronic record' means a contract or other record created, generated, sent, communicated, received, or stored by electronic means.  (5) ELECTRONIC SIGNATURE- The term 'electronic signature' means an electronic sound, symbol, or process, attached to or logically associated with a contract or other record and executed or adopted by a person with the intent to sign the record. Quelle: ESIGN Act Sec 106 (US federal law) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 125 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Anforderungen an digitale Signaturen (analog „echter“ Unterschriften)  Identifikation  Lässt die Person des Unterzeichners erkennen  Die Signatur kann nicht erneut benutzt oder für ein anderes Dokument „kopiert“ werden  Echtheit  Der Unterzeichner hat das Dokument gesehen und anerkannt  Die Signatur passt exakt nur zum signierten Dokument  Abschluss  Der Unterzeichner stimmt dem Text inhaltlich zu  Die Signatur kann nicht abgestritten werden  Warnung  Die Unterzeichnung ist eine bewusste Handlung und macht dem Unterzeichner so dessen Bedeutung klar Quelle: IT-Sicherheit, Claudia Eckert, 9. Auflage, S. 397 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 126 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Digitale Signaturverfahren  Als Signaturverfahren kommen z.B. RSA oder der 1991 von NIST/NSA in USA entwickelte Digital Signature Algorithm (DSA) zum Einsatz  Das allgemeine Vorgehen ist recht einfach:  Es wird ein Hash vom zu signierenden Dokument erstellt  Second Preimage resistance: Gefälschte Daten mit demselben Hash können kaum realistisch erzeugt werden  Der Unterzeichner signiert den Hash mit seinem privaten Schlüssel  Dritte können nun mit dem öffentlichen Schlüssel die Signatur überprüfen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 127 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Digitale Signaturverfahren zur Authentifizierung  Alice (Client) möchte das Angebot von Bob (Server) nutzen  Dazu muss sich Alice ausweisen  Bob kennt vorab Alices öffentlichen Schlüssel  Bob schickt nun eine Zufallszahl R zu Alice  Alice schickt die mit ihrem privaten Schlüssel signierte Zufallszahl zurück  Bob prüft die Signatur und gibt Alice den Zugriff frei Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 128 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Public-Key-Infrastruktur  Web Of Trust  TrustCenter als für alle vertrauenswürdige zentrale Instanz  Zertifikatshierarchie  Certificate Authority (CA)  Organisation, die Zertifikate ausstellt und überprüft  Intermediate CA  Zertifikat  Registration Authority (RA)  Certificate Revocation List (CRL)  Zertifikatsperrliste. Ermöglicht das Sperren eines Zertifikats z. B. dann, wenn der zugehörige private Schlüssel kompromittiert wurde (z. B. von einem Täter entwendet). Achtung: Clients müssen irgendwie von einem gesperrten Zertifikat erfahren!  Praxisbeispiel: Zertifikatshierarchie in Webbrowsern → schauen wir uns morgen in der Übung praktisch an Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 129 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Zertifikatshierarchien  Der Zertifikatherausgeber Trustwave verkaufte ein „Masterzertifikat“ an eine Firma zur Verwendung in einem Data Loss Prevention System (DLP)  Damit konnte diese Firma die digitale Identität jeder anderen Firma annehmen, bzw. für beliebige Systeme Zertifikate ausstellen  „Problem“: Jede CA und jede Sub-CA kann Zertifikate für beliebige Systeme/Server ausstellen http://www.heise.de/newsticker/meldung/Trustwave-verkaufte-Man-in-the-Middle-Zertifikat-1429722.html (07.02.2012) Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 130 Digitale Signaturen, Zertifikatssysteme, Authentifizierung Digitale Zertifikate im Praxiseinsatz Quelle: Laudon/Laudon/Schoder (2015), Abbildung 15.12 Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 131 Elektronisches Bargeld (Beispiel nach Prof. Ertel)  Physisches Geld (Geldscheine, Münzen) hat gute Eigenschaften:  Anonymer Transfer ist möglich  Gewisser Schutz vor Fälschung  Transferkosten grundsätzlich gleich Null  …aber auch problematische Eigenschaften:  Verlust- und Diebstahlrisiko  Logistischer Aufwand bei größeren Transaktionen  Lagerung  Produktionskosten  Medienbruch → Online kaufen, offline bezahlen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 132 Elektronisches Bargeld (Beispiel nach Prof. Ertel)  Elektronisches Bargeld muss für effizienten E-Commerce einige Anforderungen erfüllen:  Geringe/keine Transaktionskosten (Micro Payment)  Bei Bedarf so anonym wie Bargeld  Sicher gegen Betrug (fälschungssicher, nichtabstreitbar)  Austausch zwischen Verbrauchern auch ohne zentrale Bank, oder zumindest ohne dadurch entstehende Kosten  Die moderne Kryptographie kann diese Anforderungen erfüllen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 133 Elektronisches Bargeld (Beispiel nach Prof. Ertel) Ecash, Entwurf Nr. 1  Speicherung des Wertes in einer simplen Datei  Problem: Fälschung ist völlig mühelos möglich 1 YTL 10.000 YTL 1 YTL Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 134 Elektronisches Bargeld (Beispiel nach Prof. Ertel) Ecash, Entwurf Nr. 2  Zusätzlich digitale Signatur der ausstellenden Bank  Problem: Kopieren ist völlig mühelos möglich 1 YTL fkJc38—d35cx 1 YTL fkJc38—d35cx 1 YTL fkJc38—d35cx 1 YTL fkJc38—d35cx 1 YTL fkJc38—d35cx 1 YTL fkJc38—d35cx Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 135 Elektronisches Bargeld (Beispiel nach Prof. Ertel) Ecash, Entwurf Nr. 3  Zusätzlich Kodierung einer Seriennummer  Problem: Anonymität nun nicht mehr gegeben 1 YTL fkJc38—d35cx 4711 1 YTL fkJc38—d35cx 4711 X Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 136 Elektronisches Bargeld (Beispiel nach Prof. Ertel) Ecash, Entwurf Nr. 4  Blinde Signatur, dadurch Anonymität gewährleistet  Kunde/Benutzer generiert selbst Ecash, Bank bestätigt dies fkJc38—d35cx 1 YTL471 1 1 YTL471 1 1 YTL471 1 1 YTL471 1 1 YTL 4711 1 YTL471 1 1 YTL471 1 1 YTL471 1 1 YTL471 1 1 YTL 4711 99 Münzen in den „Müll“ 100 Münzen werden generiert 1 Münze wird blind signiert Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 137 Anwendungsbeispiele: Übertragungsverschlüsselung SSL/TLS  Idee  Bidirektionale Verbindungen durch kryptographische Verfahren schützen, etwa HTTP  Transport Layer Security (TLS)  Frühere Bezeichnung: Secure Sockets Layer (SSL)  Client und Server kommunizieren verschlüsselt unter Verwendung von Zertifikaten (PKI)  Vielleicht bekanntestes Beispiel: „HTTPS://“  OpenSSL  LibreSSL Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 138 Anwendungsbeispiele: Übertragungsverschlüsselung SMIME, PGP und GPG  Idee  Nachrichten effizient vertraulich, zurechenbar und integritätsgeschützt übertragen und im Postfach speichern  Transitives Vertrauen  Wenn A den Personen B und C vertraut,  Und D vertraut Person A  Dann kann Person D auch Person B und C vertrauen Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 139 Anwendungsbeispiele: Verschlüsselung von ruhenden Daten Dateibasiert  Idee  Verschlüsselung einer oder mehrerer Dateien, um diese sicher „lagern“ oder weiter geben zu können (z.B. per E-Mail versenden)  Frage: welche Gefahren/Nachteile sehen Sie?  AES-verschlüsseltes ZIP-Archiv  PGP/GPG  Encrypting File System (EFS) in Windows  … Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 140 Anwendungsbeispiele: Verschlüsselung von ruhenden Daten Containerbasiert  Idee  Verschlüsselung einer (großen) Datei, die mit einem Dateisystem ausgestattet wird und so als Laufwerk/Volume verwendet werden kann  Abstraktionslayer im Betriebssystem oder User-Land, der die Verschlüsselung erledigt und in die obere Ebene ein normales Block- Device liefert  Veracrypt  Bitlocker Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 141 Anwendungsbeispiele: Verschlüsselung von ruhenden Daten Full-Disk-Encryption  Idee  Verschlüsselung des kompletten Datenträgers/Festplatte (meist jedoch ohne Bootloader – Frage: warum?)  Abstraktionslayer im Betriebssystem, der die Verschlüsselung erledigt und in die obere Ebene ein normales Block-Device liefert  Windows Bitlocker  Apple FileVault  FreeBSD GEOM Based Disk Encryption (gbde) und geli  https://www.freebsd.org/doc/de/books/handbook/disks-encrypting.html  Linux dm-crypt und LUKS  https://wiki.archlinux.org/index.php/Dm-crypt  Hardwarebasiert: TCG OPAL Informationssicherheit und IT-Forensik | Einheit 1-04 | M.Sc. Phil Knüfer – phil.knuefer@rub.de | Inhalte z.T. von DigiTrace GmbH bereitgestellt 142 Ein Auftrag an Sie: Unser Musterfall Wiederkehrende, vorlesungs- und übungsbegleitende Übungsaufgabe  Überarbeiten Sie (als Hausaufgabe) Ihre Planung für die Errichtung einer „smarten“ Einbruchmeldeanlage 2.0 für das Handwerksunternehmen Ihrer Eltern  Beantworten und begründen Sie unter eigenen Annahmen z.B. folgende Fragen:  Ändern Sie Ihre bisherige Planung?  Beabsichtigen Sie, Kryptographie-Techniken zu implementieren?  Welche? Mit welchem Zweck/Zielsetzung?  Skizzieren Sie mögliche Problemstellen. Wo könnten Probleme lauern?","libVersion":"0.3.2","langs":""}